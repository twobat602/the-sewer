local player = game.Players.LocalPlayer
local redzlib = loadstring(game:HttpGet("https://raw.githubusercontent.com/tbao143/Library-ui/refs/heads/main/Redzhubui"))()
local Window = redzlib:MakeWindow({
    Title = "redz Hub : The Sewers",
    SubTitle = "by Twobat",
    SaveFolder = "testando | redz lib v5.lua"
})

Window:AddMinimizeButton({
    Button = { Image = "rbxassetid://119965632862212", BackgroundTransparency = 0 },
    Corner = { CornerRadius = UDim.new(35, 1) },
})

-- Player Tab
local TabPlayer = Window:MakeTab({"Player", "person"})
Window:SelectTab(TabPlayer)

-- Initial player list
local playerNames = {}
for _, plr in ipairs(game.Players:GetPlayers()) do
    if plr ~= player then -- Hindi isasama ang sarili sa listahan
        table.insert(playerNames, plr.Name)
    end
end

-- Player List Dropdown
local selectedPlayer = nil
local playerDropdown = TabPlayer:AddDropdown({
    Name = "Players List",
    Description = "Select a player to teleport to",
    Options = playerNames, 
    Default = "",
    Flag = "PlayerDropdown",
    Callback = function(Value)
        selectedPlayer = Value
    end
})

-- Function para i-update ang player list
local function updatePlayerList()
    local updatedNames = {}
    for _, plr in ipairs(game.Players:GetPlayers()) do
        if plr ~= player then -- Hindi isasama ang sarili
            table.insert(updatedNames, plr.Name)
        end
    end
    playerDropdown:Refresh(updatedNames, selectedPlayer or "")
end

-- Auto-refresh kapag may nag-join o nag-leave
game.Players.PlayerAdded:Connect(updatePlayerList)
game.Players.PlayerRemoving:Connect(updatePlayerList)

-- Teleport Button (Ikaw ang pupunta sa napiling player)
TabPlayer:AddButton({"Teleport to Player", function()
    if selectedPlayer then
        local targetPlayer = game.Players:FindFirstChild(selectedPlayer)
        if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
        end
    end
end})

local Paragraph = TabPlayer:AddParagraph({"How to use bring player", "Click the Bring button first and place it in the ground, and select player, create a clan\nask the player to join and ask to sit. Go to loc you want and click bring ang place the beanbag on the ground"})

-- Get BeanBag Button
TabPlayer:AddButton({"Bring player", function()
    local beanBag = game.Workspace.DynamicFurniture:FindFirstChild("BeanBag")
    if beanBag and beanBag:FindFirstChild("MeshPart") then
        local meshPart = beanBag.MeshPart
        local ownerAttribute = beanBag:GetAttribute("Owner")

        if ownerAttribute == nil or ownerAttribute == player.UserId then
            local frontPosition = player.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -5)
            meshPart.CFrame = frontPosition
        end
    end
end})

local TabCollect = Window:MakeTab({"Collect", "cherry"})

local Paragraph = TabCollect:AddParagraph({"Farm gear/bottle", "This is not automatically place, you need a Extractor for farming gear and bottle"})

TabCollect:AddButton({"Collect All Scrap2", function()
    for _, scrap in ipairs(game.Workspace.DynamicFurniture:GetChildren()) do
        if scrap:IsA("Model") and scrap.Name == "Scrap2" then
            local ownerAttribute = scrap:GetAttribute("Owner")

            -- Iteteleport lang ang Scrap2 kung wala itong may-ari
            if ownerAttribute == nil then
                local playerRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                local smoothPart = scrap:FindFirstChildWhichIsA("MeshPart") -- Hahanapin ang MeshPart
                
                if playerRoot and smoothPart then
                    smoothPart.CFrame = playerRoot.CFrame * CFrame.new(0, 0, -2)
                end
            end
        end
    end
end})

TabCollect:AddButton({"Collect All Pallet2", function()
    for _, pallet in ipairs(game.Workspace.DynamicFurniture:GetChildren()) do
        if pallet:IsA("Model") and pallet.Name == "Pallet2" then
            local ownerAttribute = pallet:GetAttribute("Owner")

            -- Iteteleport lang ang Pallet2 kung wala itong may-ari
            if ownerAttribute == nil then
                local playerRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
                if playerRoot then
                    pallet:SetPrimaryPartCFrame(playerRoot.CFrame * CFrame.new(0, 0, -2))
                end
            end
        end
    end
end})

local TabSetting = Window:MakeTab({"Setting", "apple"})

local savedPosition = nil -- Variable para sa saved position

-- Save Position Button
TabSetting:AddButton({"Save Position", function()
    local playerRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if playerRoot then
        savedPosition = playerRoot.CFrame
        print("Position Saved:", savedPosition)
    end
end})

-- Teleport to Saved Position Button
TabSetting:AddButton({"Teleport to Saved Position", function()
    local playerRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if playerRoot and savedPosition then
        playerRoot.CFrame = savedPosition
        print("Teleported to Saved Position")
    end
end})

